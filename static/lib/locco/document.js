// Generated by CoffeeScript 1.6.3
(function() {
  var Data, Document, _, _module, _ref,
    __hasProp = {}.hasOwnProperty;

  _ = require('../../general/chocodash');

  Data = require('../../general/locco/data');

  Document = _.prototype({
    constructor: function(o) {
      var materialize;
      if ((o != null ? o.uuid : void 0) == null) {
        o = new Data;
      }
      materialize = function(o, root, parent) {
        var idoc, key, member;
        if ((o == null) || typeof o !== 'object') {
          return o;
        }
        idoc = parent == null ? root : new o.constructor();
        for (key in o) {
          if (!__hasProp.call(o, key)) continue;
          idoc[key] = materialize(o[key], root, o.matter ? idoc : parent);
        }
        if ((idoc.uuid != null) && (parent != null)) {
          idoc.parent = parent;
        }
        Data.register(idoc);
        if (parent != null) {
          if (idoc.name != null) {
            if (parent.members == null) {
              parent.members = {};
            }
            member = parent.members[idoc.name];
            if (member != null) {
              if (_.type(member) === _.Type.Array) {
                member.push(idoc);
              } else {
                parent.members[idoc.name] = [member, idoc];
              }
            } else {
              parent.members[idoc.name] = idoc;
            }
          } else if (idoc.uuid != null) {
            (parent.items != null ? parent.items : parent.items = []).push(idoc);
          }
        }
        return idoc;
      };
      return materialize(o, this);
    }
  });

  _module = typeof window !== "undefined" && window !== null ? window : module;

  if (_module.exports != null) {
    _module.exports = Document;
  } else {
    if ((_ref = window.Locco) != null) {
      _ref.Document = Document;
    }
  }

}).call(this);
