// Generated by CoffeeScript 1.6.1
(function() {
  var Data, Document, _module,
    __hasProp = {}.hasOwnProperty;

  _module = typeof window !== "undefined" && window !== null ? window : module;

  Data = require('../../general/intentware/data');

  _module.exports = Document = (function() {

    function _Class(o) {
      var materialize;
      if ((o != null ? o.uuid : void 0) == null) {
        o = new Data;
      }
      materialize = function(o, root, parent) {
        var idoc, key, member, _ref, _ref1;
        if ((o == null) || typeof o !== 'object') {
          return o;
        }
        idoc = parent == null ? root : new o.constructor();
        for (key in o) {
          if (!__hasProp.call(o, key)) continue;
          idoc[key] = materialize(o[key], root, o.matter ? idoc : parent);
        }
        if ((idoc.uuid != null) && (parent != null)) {
          idoc.parent = parent;
        }
        Data.register(idoc);
        if (parent != null) {
          if (idoc.name != null) {
            if ((_ref = parent.members) == null) {
              parent.members = {};
            }
            member = parent.members[idoc.name];
            if (member != null) {
              if (Data.type(member) === Data.Type.Array) {
                member.push(idoc);
              } else {
                parent.members[idoc.name] = [member, idoc];
              }
            } else {
              parent.members[idoc.name] = idoc;
            }
          } else if (idoc.uuid != null) {
            ((_ref1 = parent.items) != null ? _ref1 : parent.items = []).push(idoc);
          }
        }
        return idoc;
      };
      return materialize(o, this);
    }

    return _Class;

  })();

  if (typeof window !== "undefined" && window !== null) {
    window.Intentware.Document = window.exports;
  }

}).call(this);
